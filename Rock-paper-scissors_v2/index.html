<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Rock-Paper-Scissors game</title>

    <style>
        html {
            font-family: sans-serif;
        }
        body {
            width: 60%;
            max-width: 800px;
            min-width: 540px;
            margin: 0 auto;
        }

        p {
            padding-bottom: 20px;
        }

        #btnRow {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="form" id="userInput">
        <p class="gameDescriptor"> Let's play rock-paper-scissors. I've made my choice. Make yours.</p>
        <div id="btnRow" class="btn">
            <button>Rock</button>
            <button>Paper</button>
            <button>Scissors</button>
        </div>
        <p class="gameStatus1"> </p>
        <p class="gameStatus2"> </p>
    </div>

    <script>
        let computerChoice;
        let userChoice;
        const choiceMap = {
            1: "rock",
            2: "paper",
            3: "scissors"
        };

        function getComputerChoice() {
            var thisChoice = Math.floor(Math.random() * 3) + 1;
            return choiceMap[thisChoice];
        }


        function throwDown() {
            // determine whether the user or the computer has the winning choice
            const outcomes = {
                rock: { beats: 'scissors', losesTo: 'paper' },
                paper: { beats: 'rock', losesTo: 'scissors' },
                scissors: { beats: 'paper', losesTo: 'rock' }
            };

            //console.log(`||${userChoice}||`);

            let statusPrefix = "I went with " + computerChoice + ". ";
            if (userChoice === computerChoice) {
                //console.log("It's a tie!");
                statusLine1.textContent = statusPrefix + "It's a tie!";
            } else if (outcomes[userChoice].beats === computerChoice) {
                //console.log("You win!");
                statusLine1.textContent = statusPrefix + "You won that round!!";
                myRoundsWon++;
            } else {
                //console.log("You lose!");
                statusLine1.textContent = "I beat you this time with " + computerChoice + ".";
                computerRoundsWon++;
            }

            //console.log("Score (you/me): " + myRoundsWon + "/ " + computerRoundsWon);
        }

        function playGame(event) {
            // this handles each round of play, making sure the user's submission is valid
            // and then calling throwDown to compare the user's choice to the computer's

            console.clear();
            userChoice = event.target.textContent.toLowerCase();
            computerChoice = getComputerChoice();
            console.log (`user/computer choices are: ${userChoice} / ${computerChoice}`);

            console.log("Let's play!");

            if (roundsPlayed < MaxRounds-1) {
                
                console.log("User entered: " + userChoice + ", against: " + computerChoice);

                if (userChoice !== 0) {
                    ++roundsPlayed;
                    throwDown();
                } else {
                    //console.log("bad user input");
                    statusLine1.textContent = "That's not one of the three. Try again.";
                }
            } else {
                statusLine2.textContent = "Game over. You won " + myRoundsWon + getRoundWord(myRoundsWon);
                statusLine2.textContent += " I won " + computerRoundsWon + getRoundWord(computerRoundsWon);
            }
        }
        
        //initialize the variables that we need to stat things off, plus set function to process user input.
        let statusLine1 = document.querySelector('.gameStatus1');
        let statusLine2 = document.querySelector('.gameStatus2');


        let roundsPlayed = 0;
        const MaxRounds = 5000;
        let myRoundsWon = 0;
        let computerRoundsWon = 0;

        let btnRow = document.querySelector('#btnRow')
        btnRow.addEventListener('click', playGame);
    </script>
</body>
</html>